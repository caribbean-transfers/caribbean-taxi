!function(){var e=document.getElementById("aff-round-trip-element"),t=document.getElementById("aff-input-from"),n=document.getElementById("aff-input-to"),i=document.getElementById("aff-input-to-from"),a=document.getElementById("aff-input-to-to"),o=document.getElementById("aff-input-passengers"),u=document.getElementById("aff-input-to-passengers"),m=document.getElementById("aff-input-pickup-date"),r=document.getElementById("aff-input-to-pickup-date"),c=document.getElementById("aff-input-pickup-time"),s=document.getElementById("aff-input-to-pickup-time"),l=document.getElementById("aff-button-send"),p=document.getElementById("aff-error-list"),d=(document.getElementById("aff-affiliate-id"),document.getElementById("aff-channel"),{en:{"quote.from.input":"Please, enter the pickup location","quote.from.date":"Please, enter your pickup date","quote.to.input":"Please, enter the destination","quote.to.date":"Please, enter your return date"},es:{"quote.from.input":"Por favor, introduzca el lugar de recogida","quote.from.date":"Por favor, introduzca su fecha de recogida","quote.to.input":"Por favor, introduzca el destino","quote.to.date":"Por favor, introduzca su fecha de regreso"}}),f={lang:"es",currency:"USD",deeplink:"/search-result",serviceType:"OW",pax:1,items:{from:{name:"",latitude:"",longitude:"",pickupDate:"",pickupTime:"00:00"},to:{name:"",latitude:"",longitude:"",pickupDate:"",pickupTime:"00:00"}},setCurrency:function(e){e=e.toUpperCase(),["USD","MXN"].includes(e)&&(this.currency=e)},setServiceType:function(e){e=e.toUpperCase(),["OW","RT"].includes(e)&&(this.serviceType=e)},setPax:function(e){f.pax=e,u.value=e},setItem:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};document.getElementById(e).innerHTML="","aff-input-from-elements"===e&&(document.getElementById("aff-input-from").value=t.name,f.items.from.name=t.name,f.items.from.latitude=t.geo.lat,f.items.from.longitude=t.geo.lng,a.value=t.name),"aff-input-to-elements"===e&&(document.getElementById("aff-input-to").value=t.name,f.items.to.name=t.name,f.items.to.latitude=t.geo.lat,f.items.to.longitude=t.geo.lng,i.value=t.name)},setTime:function(e,t){"init"===e&&(f.items.from.pickupTime=t),"end"===e&&(f.items.to.pickupTime=t)},autocomplete:function(e,t){var n=this;if(e.length<3)return!1;f.loadingMessage(t),fetch("/api/autocomplete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({keyword:e})}).then((function(e){return e.json()})).then((function(e){n.makeItems(e,t)})).catch((function(e){console.error("Error:",e)}))},makeItems:function(e,t){var n=document.getElementById(t);n.innerHTML="",e=e.items;var i=function(i){if(e.hasOwnProperty(i)){var a=document.createElement("div");a.textContent=e[i].name;var o=document.createElement("span");o.textContent=e[i].address,a.appendChild(o),a.addEventListener("click",(function(){f.setItem(t,e[i])})),n.appendChild(a)}};for(var a in e)i(a)},loadingMessage:function(e){var t=document.getElementById(e);t.innerHTML="";var n=document.createElement("div");n.classList.add("loader");var i=document.createElement("img");i.src="/assets/img/loader.gif",n.appendChild(i),t.appendChild(n)},errorMessage:function(){document.getElementById(item).textContent="Error"},getTranslation:function(e){return d[f.lang][e]?d[f.lang][e]:"Translate not found"},validate:function(){if(f.clearErrors(),!this.items.from.name||""===this.items.from.name.trim()||!this.items.from.latitude||""===this.items.from.latitude.toString().trim()||!this.items.from.longitude||""===this.items.from.longitude.toString().trim())return f.hightlight(t,this.getTranslation("quote.from.input")),!1;if(!this.items.to.name||""===this.items.to.name.trim()||!this.items.to.latitude||""===this.items.to.latitude.toString().trim()||!this.items.to.longitude||""===this.items.to.longitude.toString().trim())return f.hightlight(n,this.getTranslation("quote.to.input")),!1;if(!this.items.from.pickupDate||""===this.items.from.pickupDate.toString().trim())return f.hightlight(m,this.getTranslation("quote.from.date")),!1;if("RT"===this.serviceType&&(!this.items.to.pickupDate||""===this.items.to.pickupDate.toString().trim()))return f.hightlight(r,this.getTranslation("quote.to.date")),!1;var e={type:f.serviceType,currency:f.currency,language:f.lang,passengers:f.pax,from:{name:f.items.from.name,lat:f.items.from.latitude,lng:f.items.from.longitude,pickupDate:f.items.from.pickupDate,pickupTime:f.items.from.pickupTime},to:{name:f.items.to.name,lat:f.items.to.latitude,lng:f.items.to.longitude,pickupDate:f.items.to.pickupDate,pickupTime:f.items.to.pickupTime}};localStorage.setItem("bookingbox",JSON.stringify(e));var i=document.createElement("form");i.method="post",i.action="/search-result";var a=document.createElement("input");a.type="text",a.name="type",a.value=f.serviceType,i.appendChild(a);var o=document.createElement("input");o.type="text",o.name="currency",o.value=f.currency,i.appendChild(o);var u=document.createElement("input");u.type="text",u.name="language",u.value=f.lang,i.appendChild(u);var c=document.createElement("input");c.type="text",c.name="passengers",c.value=f.pax,i.appendChild(c);var s=document.createElement("input");s.type="text",s.name="from",s.value=f.items.from.name,i.appendChild(s);var l=document.createElement("input");l.type="text",l.name="from_latitude",l.value=f.items.from.latitude,i.appendChild(l);var p=document.createElement("input");p.type="text",p.name="from_longitude",p.value=f.items.from.longitude,i.appendChild(p);var d=document.createElement("input");d.type="text",d.name="from_pickup_date",d.value=f.items.from.pickupDate+" "+f.items.from.pickupTime,i.appendChild(d);var g=document.createElement("input");g.type="text",g.name="to",g.value=f.items.to.name,i.appendChild(g);var v=document.createElement("input");v.type="text",v.name="to_latitude",v.value=f.items.to.latitude,i.appendChild(v);var h=document.createElement("input");if(h.type="text",h.name="to_longitude",h.value=f.items.to.longitude,i.appendChild(h),"RT"===this.serviceType){var y=document.createElement("input");y.type="text",y.name="to_pickup_date",y.value=f.items.to.pickupDate+" "+f.items.to.pickupTime,i.appendChild(y)}var k=document.createElement("input");k.type="text",k.name="_token",k.value=document.querySelector('meta[name="csrf-token"]').content,i.appendChild(k),document.body.appendChild(i),i.submit()},hightlight:function(e,t){e.classList.add("hightlight"),p.textContent=t},clearErrors:function(){t.classList.remove("hightlight"),n.classList.remove("hightlight"),m.classList.remove("hightlight"),r.classList.remove("hightlight"),p.textContent=""},init:function(){var e=JSON.parse(localStorage.getItem("bookingbox"));if(e){f.setCurrency(e.currency);var l=document.querySelector('.aff-toggle-currency[data-currency="'.concat(e.currency,'"]'));l&&l.click(),f.setServiceType(e.type);var p=document.querySelector('.aff-toggle-type[data-type="'.concat(e.type,'"]'));p&&p.click(),t.value=e.from.name,f.items.from.name=e.from.name,f.items.from.latitude=e.from.lat,f.items.from.longitude=e.from.lng,a.value=e.from.name,f.items.from.pickupDate=e.from.pickupDate,m.value=e.from.pickupDate,f.items.from.pickupTime=e.from.pickupTime,c.value=e.from.pickupTime,n.value=e.to.name,f.items.to.name=e.to.name,f.items.to.latitude=e.to.lat,f.items.to.longitude=e.to.lng,i.value=e.to.name,"RT"==e.type&&(f.items.to.pickupDate=e.to.pickupDate,r.value=e.to.pickupDate,f.items.to.pickupTime=e.to.pickupTime,s.value=e.to.pickupTime),f.setPax(e.passengers),o.value=e.passengers,u.value=e.passengers}}},g=document.querySelectorAll(".aff-toggle-currency");g.forEach((function(e){e.addEventListener("click",(function(){var e=this.getAttribute("data-currency");f.setCurrency(e),g.forEach((function(e){e.classList.remove("active")})),this.classList.add("active")}))}));var v=document.querySelectorAll(".aff-toggle-type");function h(e,t){var n=0;return function(){var i=this,a=arguments;clearTimeout(n),n=setTimeout((function(){e.apply(i,a)}),t||0)}}v.forEach((function(t){t.addEventListener("click",(function(){var t=this.getAttribute("data-type");f.setServiceType(t),"RT"==t?e.classList.remove("hidden"):e.classList.add("hidden"),v.forEach((function(e){e.classList.remove("active")})),this.classList.add("active")}))})),t.addEventListener("keydown",h((function(e){f.autocomplete(e.target.value,"aff-input-from-elements")}),500)),t.addEventListener("focus",(function(e){f.autocomplete(e.target.value,"aff-input-from-elements")})),n.addEventListener("keydown",h((function(e){f.autocomplete(e.target.value,"aff-input-to-elements")}),500)),n.addEventListener("focus",(function(e){f.autocomplete(e.target.value,"aff-input-to-elements")})),o.addEventListener("change",(function(){f.setPax(this.value)})),c.addEventListener("change",(function(){f.setTime("init",this.value)})),s.addEventListener("change",(function(){f.setTime("end",this.value)})),m.addEventListener("change",(function(){f.items.from.pickupDate=this.value,"OW"===f.serviceType&&(r.value=this.value,f.items.to.pickupDate=this.value),"RT"===f.serviceType&&r.value<this.value&&(r.value=this.value,f.items.to.pickupDate=this.value)})),r.addEventListener("change",(function(){f.items.to.pickupDate=this.value,m.value>this.value&&(m.value=this.value,f.items.from.pickupDate=this.value)})),l.addEventListener("click",(function(e){e.preventDefault(),f.validate()})),f.init()}();